{"ast":null,"code":"// src/components/AdicionarItemOrcamento.js\nimport React,{useState,useEffect}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function AdicionarItemOrcamento(_ref){let{onAdicionarItem}=_ref;const[descricao,setDescricao]=useState('');const[quantidade,setQuantidade]=useState(1);const[sugestoes,setSugestoes]=useState([]);const[todosItensSinapi,setTodosItensSinapi]=useState([]);const apiUrl='http://localhost:8000';const[itemSelecionado,setItemSelected]=useState(null);// Para armazenar o item SINAPI selecionado\nuseEffect(()=>{const fetchTodosItens=async()=>{try{const response=await fetch(\"\".concat(apiUrl,\"/items\"));if(!response.ok){throw new Error(\"HTTP error! status: \".concat(response.status));}const data=await response.json();setTodosItensSinapi(data);}catch(error){console.error(\"Erro ao buscar itens do SINAPI:\",error);}};fetchTodosItens();},[]);const handleDescricaoChange=event=>{const value=event.target.value;setDescricao(value);setItemSelecionado(null);// Limpa o item selecionado ao digitar\nif(value.length>=3){const filteredSugestoes=todosItensSinapi.filter(item=>item.descricao.toLowerCase().includes(value.toLowerCase()));setSugestoes(filteredSugestoes.slice(0,10));// Mostrar no máximo 10 sugestões\n}else{setSugestoes([]);}};const handleQuantidadeChange=event=>{setQuantidade(parseInt(event.target.value,10)||1);};const handleAdicionarClick=()=>{if(itemSelecionado){if(onAdicionarItem){const newItem={quantidade};if(itemSelecionado.tipo==='mao_de_obra'&&itemSelecionado.codigo_da_composicao){newItem.codigo_da_composicao=itemSelecionado.codigo_da_composicao;newItem.descricao=itemSelecionado.descricao;// Pode ser útil ter a descrição também\nnewItem.unidade=itemSelecionado.unidade;}else{newItem.id=itemSelecionado.id;}onAdicionarItem(newItem);setDescricao('');setQuantidade(1);setSugestoes([]);setItemSelecionado(null);}}else{alert(\"Por favor, selecione um item da lista de sugestões.\");}};const selecionarSugestao=item=>{setDescricao(item.descricao);setSugestoes([]);setItemSelecionado(item);// Armazena o item SINAPI selecionado\n};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Adicionar Item ao Or\\xE7amento\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"descricao\",children:\"Descri\\xE7\\xE3o:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"descricao\",value:descricao,onChange:handleDescricaoChange}),sugestoes.length>0&&/*#__PURE__*/_jsx(\"ul\",{children:sugestoes.map(item=>/*#__PURE__*/_jsxs(\"li\",{onClick:()=>selecionarSugestao(item),children:[item.descricao,\" (\",item.unidade,\")\"]},item.id))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"quantidade\",children:\"Quantidade:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"quantidade\",value:quantidade,onChange:handleQuantidadeChange,min:\"1\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleAdicionarClick,children:\"Adicionar\"})]});}export default AdicionarItemOrcamento;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","AdicionarItemOrcamento","_ref","onAdicionarItem","descricao","setDescricao","quantidade","setQuantidade","sugestoes","setSugestoes","todosItensSinapi","setTodosItensSinapi","apiUrl","itemSelecionado","setItemSelected","fetchTodosItens","response","fetch","concat","ok","Error","status","data","json","error","console","handleDescricaoChange","event","value","target","setItemSelecionado","length","filteredSugestoes","filter","item","toLowerCase","includes","slice","handleQuantidadeChange","parseInt","handleAdicionarClick","newItem","tipo","codigo_da_composicao","unidade","id","alert","selecionarSugestao","children","htmlFor","type","onChange","map","onClick","min"],"sources":["D:/Users/Guilherme/Downloads/c apagar/dias render/base de dados sinapi/sinapi_processor - fase 2/react-sinapi-app/src/components/AdicionarItemOrcamento.js"],"sourcesContent":["// src/components/AdicionarItemOrcamento.js\r\nimport React, { useState, useEffect } from 'react';\r\n\r\nfunction AdicionarItemOrcamento({ onAdicionarItem }) {\r\n  const [descricao, setDescricao] = useState('');\r\n  const [quantidade, setQuantidade] = useState(1);\r\n  const [sugestoes, setSugestoes] = useState([]);\r\n  const [todosItensSinapi, setTodosItensSinapi] = useState([]);\r\n  const apiUrl = 'http://localhost:8000';\r\n  const [itemSelecionado, setItemSelected] = useState(null); // Para armazenar o item SINAPI selecionado\r\n\r\n  useEffect(() => {\r\n    const fetchTodosItens = async () => {\r\n      try {\r\n        const response = await fetch(`${apiUrl}/items`);\r\n        if (!response.ok) {\r\n          throw new Error(`HTTP error! status: ${response.status}`);\r\n        }\r\n        const data = await response.json();\r\n        setTodosItensSinapi(data);\r\n      } catch (error) {\r\n        console.error(\"Erro ao buscar itens do SINAPI:\", error);\r\n      }\r\n    };\r\n\r\n    fetchTodosItens();\r\n  }, []);\r\n\r\n  const handleDescricaoChange = (event) => {\r\n    const value = event.target.value;\r\n    setDescricao(value);\r\n    setItemSelecionado(null); // Limpa o item selecionado ao digitar\r\n\r\n    if (value.length >= 3) {\r\n      const filteredSugestoes = todosItensSinapi.filter(\r\n        item => item.descricao.toLowerCase().includes(value.toLowerCase())\r\n      );\r\n      setSugestoes(filteredSugestoes.slice(0, 10)); // Mostrar no máximo 10 sugestões\r\n    } else {\r\n      setSugestoes([]);\r\n    }\r\n  };\r\n\r\n  const handleQuantidadeChange = (event) => {\r\n    setQuantidade(parseInt(event.target.value, 10) || 1);\r\n  };\r\n\r\n  const handleAdicionarClick = () => {\r\n    if (itemSelecionado) {\r\n      if (onAdicionarItem) {\r\n        const newItem = { quantidade };\r\n        if (itemSelecionado.tipo === 'mao_de_obra' && itemSelecionado.codigo_da_composicao) {\r\n          newItem.codigo_da_composicao = itemSelecionado.codigo_da_composicao;\r\n          newItem.descricao = itemSelecionado.descricao; // Pode ser útil ter a descrição também\r\n          newItem.unidade = itemSelecionado.unidade;\r\n        } else {\r\n          newItem.id = itemSelecionado.id;\r\n        }\r\n        onAdicionarItem(newItem);\r\n        setDescricao('');\r\n        setQuantidade(1);\r\n        setSugestoes([]);\r\n        setItemSelecionado(null);\r\n      }\r\n    } else {\r\n      alert(\"Por favor, selecione um item da lista de sugestões.\");\r\n    }\r\n  };\r\n\r\n  const selecionarSugestao = (item) => {\r\n    setDescricao(item.descricao);\r\n    setSugestoes([]);\r\n    setItemSelecionado(item); // Armazena o item SINAPI selecionado\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h3>Adicionar Item ao Orçamento</h3>\r\n      <div>\r\n        <label htmlFor=\"descricao\">Descrição:</label>\r\n        <input\r\n          type=\"text\"\r\n          id=\"descricao\"\r\n          value={descricao}\r\n          onChange={handleDescricaoChange}\r\n        />\r\n        {sugestoes.length > 0 && (\r\n          <ul>\r\n            {sugestoes.map(item => (\r\n              <li key={item.id} onClick={() => selecionarSugestao(item)}>\r\n                {item.descricao} ({item.unidade})\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        )}\r\n      </div>\r\n      <div>\r\n        <label htmlFor=\"quantidade\">Quantidade:</label>\r\n        <input\r\n          type=\"number\"\r\n          id=\"quantidade\"\r\n          value={quantidade}\r\n          onChange={handleQuantidadeChange}\r\n          min=\"1\"\r\n        />\r\n      </div>\r\n      <button onClick={handleAdicionarClick}>Adicionar</button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AdicionarItemOrcamento;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}